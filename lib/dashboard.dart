import 'dart:convert';import 'package:flutter/material.dart';import 'package:flutter_svg/svg.dart';import 'package:http/http.dart' as http;import 'full_image_view.dart';class Dashboard extends StatefulWidget {  @override  _DashboardState createState() => _DashboardState();}class _DashboardState extends State<Dashboard> {  var text = '';  List data = [];  List data2 = [];  List<String> imgUrl = [];  List<String> imgUr2 = [];  List<String> name1 = [];  List<String> name2 = [];  bool flag1 = false;  bool flag2 = false;  String url1 =      'https://api.unsplash.com/search/photos?page=1&query=pants&client_id=y8Dy2bVCPdaZtXg_HZEO9TPSJMGQ1Bze9SFCiGRWLS4';  getData() async  {    print("------" + "getData");    http.Response response = await http.get(Uri.parse(url1));    data = json.decode(response.body)['results'];    _assign();    setState(()    {      print("------" + "getData-setState");      flag1 = true;    });  }  _assign()  {    imgUrl.clear();    for (var i = 0; i < data.length; i++)    {      imgUrl.add(data.elementAt(i)["urls"]["regular"]);    }  }  late ScrollController _scrollController;                                 // NEW  @override                                                           // NEW  void initState() {    getData();    super.initState();    _scrollController = new ScrollController(                         // NEW        initialScrollOffset: 0.0,                                       // NEW        keepScrollOffset: true,    );    _scrollController.addListener(()    {      if (_scrollController.position.pixels ==          _scrollController.position.maxScrollExtent)      {        getData();      }    }    );  }  @override  Widget build(BuildContext context) {    print("build" + flag1.toString() + "| "+imgUrl.toString());    return Scaffold(      body: getBody(),    );  }  Widget getBody() {    return SafeArea(        child: SingleChildScrollView(      child: Padding(        padding: const EdgeInsets.symmetric(horizontal: 30, vertical: 30),        child: Column(          children: <Widget>[            Row(              mainAxisAlignment: MainAxisAlignment.spaceBetween,              children: <Widget>[                SvgPicture.asset("assets/images/burger_icon.svg"),                Row(                  children: <Widget>[                    SvgPicture.asset("assets/images/search_icon.svg"),                    SizedBox(                      width: 20,                    ),                    Container(                      height: 50,                      width: 50,                      decoration: BoxDecoration(                          shape: BoxShape.circle,                          image: DecorationImage(                              image: NetworkImage(                                  "https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=800&q=60"),                              fit: BoxFit.cover)),                    )                  ],                )              ],            ),            SizedBox(              height: 40,            ),            Row(              mainAxisAlignment: MainAxisAlignment.spaceBetween,              children: <Widget>[                Text(                  "Top Designer",                  style: TextStyle(fontSize: 30, fontWeight: FontWeight.bold),                ),                SvgPicture.asset("assets/images/forward_icon.svg")              ],            ),            SizedBox(              height: 30,            ),            SingleChildScrollView(              scrollDirection: Axis.horizontal,              child: Row(                children: <Widget>[                  Padding(                    padding: const EdgeInsets.only(right: 20),                    child: Column(                      children: <Widget>[                        InkWell(                          onTap: () {                            url1 =                                'https://api.unsplash.com/search/photos?page=1&query=pants&client_id=y8Dy2bVCPdaZtXg_HZEO9TPSJMGQ1Bze9SFCiGRWLS4';                            text = 'Pants';                            getData();                            setState(() {});                          },                          child: Container(                            width: 80,                            height: 80,                            decoration: BoxDecoration(                                shape: BoxShape.circle,                                image: DecorationImage(                                    image: NetworkImage(                                        "https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80"),                                    fit: BoxFit.cover)),                          ),                        ),                        SizedBox(                          height: 15,                        ),                        Text("Pants")                      ],                    ),                  ),                  Padding(                    padding: const EdgeInsets.only(right: 20),                    child: Column(                      children: <Widget>[                        InkWell(                          onTap: () {                            url1 =                                'https://api.unsplash.com/search/photos?page=1&query=shoes&client_id=y8Dy2bVCPdaZtXg_HZEO9TPSJMGQ1Bze9SFCiGRWLS4';                            text = 'Shoes';                            getData();                            setState(() {                            });                          },                          child: Container(                            width: 80,                            height: 80,                            decoration: BoxDecoration(                                shape: BoxShape.circle,                                image: DecorationImage(                                    image: NetworkImage(                                        "https://images.unsplash.com/photo-1542291026-7eec264c27ff?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8c2hvZXN8ZW58MHx8MHx8&auto=format&fit=crop&w=400&q=60"),                                    fit: BoxFit.cover)),                          ),                        ),                        SizedBox(                          height: 15,                        ),                        Text("Shoes")                      ],                    ),                  ),                  Padding(                    padding: const EdgeInsets.only(right: 20),                    child: Column(                      children: <Widget>[                        InkWell(                          onTap: () {                            url1 =                                'https://api.unsplash.com/search/photos?page=1&query=shirts&client_id=y8Dy2bVCPdaZtXg_HZEO9TPSJMGQ1Bze9SFCiGRWLS4';                            text = 'Shirts';                            getData();                            setState(() {});                          },                          child: Container(                            width: 80,                            height: 80,                            decoration: BoxDecoration(                                shape: BoxShape.circle,                                image: DecorationImage(                                    image: NetworkImage(                                        "https://images.unsplash.com/photo-1576566588028-4147f3842f27?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=464&q=80"),                                    fit: BoxFit.cover)),                          ),                        ),                        SizedBox(                          height: 15,                        ),                        Text("Shirts")                      ],                    ),                  ),                  Padding(                    padding: const EdgeInsets.only(right: 20),                    child: Column(                      children: <Widget>[                        InkWell(                          onTap: () {                            url1 =                                'https://api.unsplash.com/search/photos?page=1&query=hats&client_id=y8Dy2bVCPdaZtXg_HZEO9TPSJMGQ1Bze9SFCiGRWLS4';                            text = 'Hats';                            getData();                            setState(() {});                          },                          child: Container(                            width: 80,                            height: 80,                            decoration: BoxDecoration(                                shape: BoxShape.circle,                                image: DecorationImage(                                    image: NetworkImage(                                        "https://images.unsplash.com/photo-1556306535-0f09a537f0a3?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"),                                    fit: BoxFit.cover)),                          ),                        ),                        SizedBox(                          height: 15,                        ),                        Text("Hats")                      ],                    ),                  )                ],              ),            ),            SizedBox(              height: 40,            ),            Row(              mainAxisAlignment: MainAxisAlignment.spaceBetween,              children: <Widget>[                Text(                  "Popular Design",                  style: TextStyle(fontSize: 30, fontWeight: FontWeight.bold),                ),                SvgPicture.asset("assets/images/forward_icon.svg")              ],            ),            SizedBox(              height: 40,            ),            Column(              children: <Widget>[                Container(                  width: 100,                  height: 10,                ),                // HomePage3()              ],            ),            SizedBox(              child: GridView.builder(                controller: _scrollController,                itemCount: imgUrl.length,                scrollDirection: Axis.vertical,                shrinkWrap: true,                primary: false,                gridDelegate: new SliverGridDelegateWithFixedCrossAxisCount(                    mainAxisSpacing: 20,crossAxisSpacing: 20,                    crossAxisCount: 2),                itemBuilder: (BuildContext context, int index) {                  print(flag1);                  print(imgUrl[index]);                  return InkWell(                      onTap: () {                        Navigator.push(context,                            MaterialPageRoute(builder: (context) => FullImageView(url: imgUrl[index])));                      },                    child: Container(                    child: !flag1                  ? CircularProgressIndicator():Image.network(imgUrl[index], fit: BoxFit.cover),                  ),                  );                },              ),            ),          ],        ),      ),    ));  }}